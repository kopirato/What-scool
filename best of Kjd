<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kajiado360 Tourism Explorer</title>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: #f5f6fa;
      margin: 0;
      padding: 0;
    }
    header {
      background: #006400;
      color: white;
      text-align: center;
      padding: 1rem 0;
      font-size: 1.5rem;
      letter-spacing: 1px;
    }
    main {
      max-width: 900px;
      margin: 20px auto;
      background: white;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    h2 {
      color: #2c3e50;
      margin-top: 30px;
    }
    form {
      margin-top: 15px;
      display: grid;
      gap: 10px;
    }
    input, textarea, select, button {
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 1rem;
      width: 100%;
    }
    button {
      background: #006400;
      color: white;
      border: none;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover {
      background: #228B22;
    }
    .card {
      border: 1px solid #ddd;
      border-radius: 12px;
      padding: 15px;
      margin-top: 15px;
      background: #fafafa;
    }
    .review {
      margin-left: 15px;
      font-size: 0.95rem;
      border-left: 3px solid #006400;
      padding-left: 8px;
    }
  </style>
</head>
<body>
  <header>üåç Kajiado360 Tourism Explorer</header>
  <main>
    <h2>Add a New Tourist Site</h2>
    <form id="siteForm">
      <input type="text" id="name" placeholder="Site Name" required>
      <input type="text" id="location" placeholder="Location" required>
      <textarea id="description" placeholder="Description"></textarea>
      <input type="text" id="category" placeholder="Category (Wildlife, Culture, etc.)">
      <input type="url" id="photo_url" placeholder="Photo URL (optional)">
      <button type="submit">Add Site</button>
    </form>

    <h2>Add a Review</h2>
    <form id="reviewForm">
      <select id="siteSelect" required></select>
      <input type="text" id="visitor_name" placeholder="Your Name" required>
      <input type="number" id="rating" min="1" max="5" placeholder="Rating (1-5)" required>
      <textarea id="comment" placeholder="Your Comment" required></textarea>
      <button type="submit">Add Review</button>
    </form>

    <h2>Tourist Sites</h2>
    <div id="siteList"></div>
  </main>

  <script>
    const sites = JSON.parse(localStorage.getItem("sites")) || [];
    const reviews = JSON.parse(localStorage.getItem("reviews")) || [];

    const siteForm = document.getElementById("siteForm");
    const reviewForm = document.getElementById("reviewForm");
    const siteList = document.getElementById("siteList");
    const siteSelect = document.getElementById("siteSelect");

    // Display all sites and their reviews
    function renderSites() {
      siteList.innerHTML = "";
      siteSelect.innerHTML = "<option value=''>Select a site</option>";

      sites.forEach((site, index) => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <h3>${site.name}</h3>
          <p><strong>Location:</strong> ${site.location}</p>
          <p>${site.description}</p>
          <p><em>Category:</em> ${site.category}</p>
          ${site.photo_url ? `<img src="${site.photo_url}" width="100%" style="border-radius:10px;">` : ""}
          <h4>Reviews:</h4>
        `;
        const siteReviews = reviews.filter(r => r.site_id === index);
        if (siteReviews.length === 0) {
          card.innerHTML += `<p class='review'>No reviews yet.</p>`;
        } else {
          siteReviews.forEach(r => {
            card.innerHTML += `
              <div class="review">
                <strong>${r.visitor_name}</strong> ‚≠ê${r.rating}<br>
                ${r.comment}
              </div>
            `;
          });
        }
        siteList.appendChild(card);

        // Add to select dropdown
        const opt = document.createElement("option");
        opt.value = index;
        opt.textContent = site.name;
        siteSelect.appendChild(opt);
      });
    }

    // Add new site
    siteForm.addEventListener("submit", e => {
      e.preventDefault();
      const newSite = {
        name: document.getElementById("name").value,
        location: document.getElementById("location").value,
        description: document.getElementById("description").value,
        category: document.getElementById("category").value,
        photo_url: document.getElementById("photo_url").value
      };
      sites.push(newSite);
      localStorage.setItem("sites", JSON.stringify(sites));
      siteForm.reset();
      renderSites();
    });

    // Add new review
    reviewForm.addEventListener("submit", e => {
      e.preventDefault();
      const newReview = {
        site_id: parseInt(document.getElementById("siteSelect").value),
        visitor_name: document.getElementById("visitor_name").value,
        rating: parseInt(document.getElementById("rating").value),
        comment: document.getElementById("comment").value
      };
      reviews.push(newReview);
      localStorage.setItem("reviews", JSON.stringify(reviews));
      reviewForm.reset();
      renderSites();
    });

    renderSites();
  </script>
</body>
</html>
